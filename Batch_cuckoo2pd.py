import json
import csv
import pandas as pd
from pprint import pprint
from pandas.io.json import json_normalize
for n in range(1,200,1): 
	data = json.load(open("/home/rush/Downloads/Report/new/qw/2mal/"+str(n)+"/reports/report.json"))
	json_str = json.dumps(data)
	data = json.loads(json_str)
	calls_list=[]
	
	print("File ID:"+str((data['info']['id'])))
	print("Filename:"+str(data['target']['file']['name']))
	print("md5:"+str(data['target']['file']['md5']))
	print("File size:"+str(data['target']['file']['size']))
	
	try:
		print("Number of processes created:"+str(len((data['behavior']['processes']))))
		for i in range(1,len((data['behavior']['processes']))):
			#print(data['behavior']['processes'][i]['calls'])
			calls=(data['behavior']['processes'][i]['calls'])
			calls_list.append(pd.json_normalize(calls))
		all_calls=pd.concat(calls_list)
		#all_calls is the pandas dataframe
		#print(all_calls)
		nm=str((data['target']['file']['name']))
		all_calls.to_csv(('calls_'+str(nm)+'.csv'),mode='w',columns=['api'],index=False)
		print("Created calls"+str(nm)+".csv")
	except:
		print('Skipped file'+"/home/rush/Downloads/Report/new/qw/2mal/"+str(n)+"/reports/report.json")
